---                
layout: post                
title: "ES6 学习"                
date:   2020-7-16 17:30:00                 
categories: "Web"                
catalog: true                
tags:                 
    - Web                
---      

[https://es6.ruanyifeng.com/](https://es6.ruanyifeng.com/)

### let & const
ES6 新增了let命令，用来声明变量。它的用法类似于var，但是所声明的变量，只在let命令所在的代码块内有效。  

    for (let i = 0; i < 10; i++) {
        // ...
    }
    console.log(i);    // ReferenceError: i is not defined

var命令会发生“变量提升”现象，即变量可以在声明之前使用，值为undefined。let命令所声明的变量一定要在声明后使用，否则报错。    

const声明一个只读的常量。一旦声明，常量的值就不能改变。  

### 变量的解构赋值
ES6 允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）。  

    let [a, b, c] = [1, 2, 3];

解构赋值允许指定默认值。  

    let [x, y = 'b'] = ['a']; // x='a', y='b'

字符串也可以解构赋值。这是因为此时，字符串被转换成了一个类似数组的对象。  

    const [a, b, c, d, e] = 'hello';

变量的解构赋值用途：  
1. 交换变量的值  

        let x = 1;
        let y = 2;
        [x, y] = [y, x];

2. 从函数返回多个值  

        // 返回一个数组
        function example() {
            return [1, 2, 3];
        }
        let [a, b, c] = example();

        // 返回一个对象
        function example() {
            return {
                foo: 1,
                bar: 2
            };
        }
        let { foo, bar } = example();

3. 提取 JSON 数据  

        let jsonData = {
            id: 42,
            status: "OK",
            data: [867, 5309]
        };
        let { id, status, data: number } = jsonData;
        console.log(id, status, number);
        // 42, "OK", [867, 5309]

4. 遍历 Map 结构  

    const map = new Map();
    map.set('first', 'hello');
    map.set('second', 'world');

    for (let [key, value] of map) {
        console.log(key + " is " + value);
    }
    // first is hello
    // second is world

### 字符串
传统上，JavaScript 只有indexOf方法，可以用来确定一个字符串是否包含在另一个字符串中。ES6 又提供了三种新方法。  
includes()：返回布尔值，表示是否找到了参数字符串。  
startsWith()：返回布尔值，表示参数字符串是否在原字符串的头部。  
endsWith()：返回布尔值，表示参数字符串是否在原字符串的尾部。  

    let s = 'Hello world!';
    s.startsWith('Hello') // true
    s.endsWith('!') // true
    s.includes('o') // true

### 函数的扩展
ES6 允许为函数的参数设置默认值，即直接写在参数定义的后面。  

    function log(x, y = 'World') {
        console.log(x, y);
    }
    log('Hello') // Hello World

#### 箭头函数
ES6 允许使用“箭头”（=>）定义函数。如果箭头函数不需要参数或需要多个参数，就使用一个圆括号代表参数部分。  

    var sum = (num1, num2) => num1 + num2;
    // 等同于
    var sum = function(num1, num2) {
        return num1 + num2;
    };

如果箭头函数的代码块部分多于一条语句，就要使用大括号将它们括起来，并且使用return语句返回。   
箭头函数的一个用处是简化回调函数。  

    // 正常函数写法
    [1,2,3].map(function (x) {
        return x * x;
    });

    // 箭头函数写法
    [1,2,3].map(x => x * x);

### 数组
1. find()  
    数组实例的find方法，用于找出第一个符合条件的数组成员。它的参数是一个回调函数，所有数组成员依次执行该回调函数，直到找出第一个返回值为true的成员，然后返回该成员。如果没有符合条件的成员，则返回undefined。  

        [1, 4, -5, 10].find((n) => n < 0)
        // -5

2. fill()   
    fill方法使用给定值，填充一个数组。  

        new Array(3).fill(7)
        // [7, 7, 7]

3. includes()  
Array.prototype.includes方法返回一个布尔值，表示某个数组是否包含给定的值，  

        [1, 2, 3].includes(2)     // true
        [1, 2, 3].includes(4)     // false  

### set
ES6 提供了新的数据结构 Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。  

    const s = new Set();
    [2, 3, 5, 4, 5, 2, 2].forEach(x => s.add(x));
    for (let i of s) {
        console.log(i);
    }
    // 2 3 5 4

方法:  
add(value), delete(value), has(value), clear()  

    s.add(1).add(2).add(2);    // 注意2被加入了两次
    s.size // 2
    s.has(2) // true
    s.has(3) // false

    s.delete(2);
    s.has(2) // false

Array.from方法可以将 Set 结构转为数组。  

    const items = new Set([1, 2, 3, 4, 5]);
    const array = Array.from(items);

去除数组重复成员:  

    function dedupe(array) {
        return Array.from(new Set(array));
    }
    dedupe([1, 1, 2, 3]) // [1, 2, 3]

### Map
Map是键值对的集合，“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键。   

    const map = new Map([
        ['name', '张三'],
        ['title', 'Author']
    ]);

    map.size // 2
    map.has('name') // true
    map.get('name') // "张三"

Map构造函数接手数组或set作为参数  

    const set = new Set([
        ['foo', 1],
        ['bar', 2]
    ]);
    const m1 = new Map(set);
    m1.get('foo') // 1

    const map = new Map();
    map
    .set(1, 'aaa')
    .set(1, 'bbb');
    map.get(1) // "bbb"